---
import { getCollection, render } from "astro:content";
import DocLayout from "../../layouts/DocLayout.astro";

export async function getStaticPaths() {
    const docs = await getCollection("docs");
    return docs.map((doc) => {
        // Remove extension
        let cleanId = doc.id.replace(/\.mdx?$/, "");

        // Map "project/index" to "project" slug
        const slug = cleanId.endsWith("/index")
            ? cleanId.replace("/index", "")
            : cleanId;

        return {
            params: { slug },
            props: { doc },
        };
    });
}

const { doc } = Astro.props;
const { Content } = await render(doc);
---

<DocLayout title={doc.data.title} entry={doc}>
    <Content />
</DocLayout>
